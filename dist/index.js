"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("react"),n=require("styled-components");function t(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var r=t(e),o=t(n);function i(){return i=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},i.apply(this,arguments)}function l(e,n){if(null==e)return{};var t,r,o=function(e,n){if(null==e)return{};var t,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)t=i[r],n.indexOf(t)>=0||(o[t]=e[t]);return o}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)t=i[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}function a(e,n){return n||(n=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(n)}}))}function u(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var r,o,i=[],l=!0,a=!1;try{for(t=t.call(e);!(l=(r=t.next()).done)&&(i.push(r.value),!n||i.length!==n);l=!0);}catch(e){a=!0,o=e}finally{try{l||null==t.return||t.return()}finally{if(a)throw o}}return i}(e,n)||d(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(e){return function(e){if(Array.isArray(e))return f(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||d(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(e,n){if(e){if("string"==typeof e)return f(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?f(e,n):void 0}}function f(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}var s,p,g,b,v,h,m,x,y,w,O,E,k,C,S=function(n){var t,r,o,i=u(e.useState(),2),l=i[0],a=i[1],c=e.useCallback((function(){n&&n.current&&a(n.current.getBoundingClientRect())}),[n]);return t=c,r=n,o=e.useRef(null),e.useEffect((function(){var e=r&&r.current;return o&&o.current&&e&&o.current.unobserve(e),o.current=new ResizeObserver(t),e&&o.current.observe(e),function(){o&&o.current&&e&&o.current.unobserve(e)}}),[t,r]),e.useEffect((function(){return c(),window.addEventListener("resize",c),window.addEventListener("scroll",c),function(){window.removeEventListener("resize",c),window.removeEventListener("scroll",c)}}),[c]),l},P=function(n){var t=e.useRef(),r=e.useRef();return e.useEffect((function(){t.current=n})),e.useEffect((function(){return document.addEventListener("click",e),function(){return document.removeEventListener("click",e)};function e(e){r.current&&t.current&&!r.current.contains(e.target)&&t.current(e)}}),[]),r},R=function(n,t){var r=u(e.useState(),2),o=r[0],i=r[1];return e.useEffect((function(){n&&i(function(e,n){var t=e.bottom+n;return window.innerHeight>t?"bottom":"top"}(n,t))}),[n,t]),o},T=function(){var n=e.useRef(null),t=e.useCallback((function(){n&&n.current&&n.current.focus()}),[]),r=e.useCallback((function(){n&&n.current&&n.current.blur()}),[]);return{inputRef:n,focus:t,blur:r}},j=function(n){var t=n.options,r=n.value,o=n.onOptionSelect,i=n.onEscape,l=n.search,a=u(e.useState(!1),2),c=a[0],d=a[1],f=u(e.useState(null),2),s=f[0],p=f[1],g=e.useCallback((function(){null===s&&t.length&&p(0),d(!0)}),[s,t]),b=e.useCallback((function(){d(!1),p(null)}),[]),v=e.useCallback((function(){b(),i()}),[b,i]),h=e.useCallback((function(e){switch(e.key){case"ArrowUp":if(c){if(!t.length)return;p(s-1<0?t.length-1:s-1)}else p(t.length-1),g();break;case"ArrowDown":if(c){if(!t.length)return;s+1>=t.length?p(0):p(s+1)}else p(0),g();break;case"Enter":if(null===s)return;var n=t[s];o(n);break;case"Escape":case"Tab":v();break;default:c||g()}}),[c,g,v,o,s,t]),m=e.useCallback((function(){c&&l.length||(c?b():g())}),[b,c,g,l]);return e.useEffect((function(){p(t.length?0:null)}),[t]),e.useEffect((function(){b()}),[r,b]),{dropdown:{isOpen:c,open:g,close:b,toggle:m,escape:v},pointer:{position:s,setPosition:p},handleKeyDown:h}},I=o.default.div(s||(s=a(["\nposition: relative;\nmin-height: calc(1.5em + .75rem + 2px) !important;\nwidth: 100%;\nmargin: 0;\npadding-left: .375rem;\npadding-right: .375rem;\npadding-bottom: .375rem;\nbox-sizing: border-box;\ndisplay: flex;\nbackground-color: #fff;\nborder: 1px solid #ced4da;\nborder-radius: .25rem;\ncursor: pointer;\n","\n","\n\n&:focus-within {\n    box-shadow: 0 0 0 0.2rem rgb(38 143 255 / 50%);\n}\n"])),(function(e){var n=e.dropdownPosition;return e.isDropdownOpen&&"border-".concat(n,"-right-radius: 0;\n         border-").concat(n,"-left-radius: 0;\n         border-").concat(n,"-color: #fff;")}),(function(e){return e.disabled?"pointer-events: none;\n           background-color: #e9ecef;":""})),K=["isPointerOver","isSelected","children"],z=o.default.span(p||(p=a(["\npadding: .375rem .75rem;\ndisplay: block;\nwhite-space: nowrap;\ncursor: pointer;\n\n","\n"])),(function(e){var n=e.isPointerOver,t=e.isSelected;return n?"\n            color: #fff;\n            background-color: #007bff;":t?"\n            color: #212529;\n            background-color: #f2f2f2;":void 0})),A=function(n){var t=n.isPointerOver,o=n.isSelected,a=n.children,u=l(n,K),c=e.useRef();return e.useEffect((function(){t&&c.current&&c.current.scrollIntoView({behavior:"smooth",block:"nearest",inline:"start"})}),[t]),r.default.createElement(z,i({ref:c,role:"option","aria-selected":o,title:"string"==typeof a?a:null,isPointerOver:t,isSelected:o},u),a)},V=o.default(z)(g||(g=a(["\ncursor: default;\n"]))),H=function(){return r.default.createElement(V,null,"Совпадений не найдено")},D=o.default.div(b||(b=a(["\nposition: absolute;\nleft: -1px;\npadding: 0px;\nmax-height: ","px;\nwidth: ","px;\ndisplay: flex;\nflex-direction: column;\noverflow-x: hidden;\nborder-radius: 0;\nbackground-color: white;\nborder: 1px solid #ced4da;\nbox-sizing: border-box;\nz-index: 19;\n","\n"])),(function(e){return e.maxHeight}),(function(e){return e.parentBounds.width}),(function(e){var n=e.parentBounds;return"top"===e.dropdownPosition?"bottom: ".concat(n.height,"px;\n               border-bottom: none;\n               border-top-right-radius: .25rem;\n               border-top-left-radius: .25rem;"):"top: ".concat(n.height-1,"px;\n               border-top: none;\n               border-bottom-right-radius: .25rem;\n               border-bottom-left-radius: .25rem;")})),L=function(e){var n=e.options,t=void 0===n?[]:n,o=e.content,i=e.getOptionKey,l=void 0===i?function(e){return e}:i,a=e.renderOptionText,u=void 0===a?function(e){return e}:a,c=e.onSelectOption,d=e.selectedItems,f=e.pointer,s=e.onUpdatePointer,p=e.parentBounds,g=e.maxHeight,b=void 0===g?350:g,v=e.position;return r.default.createElement(D,{dropdownPosition:v,maxHeight:b,parentBounds:p},o||(t.length?t.map((function(e,n){var t=l(e),o=n===f,i=!(!d||!d.find((function(e){return l(e)===t})));return r.default.createElement(A,{key:t,isPointerOver:o,isSelected:i,onMouseEnter:function(){return s(n)},onClick:function(n){n.stopPropagation(),c(e)}},u(e))})):r.default.createElement(H,null)))},B=o.default.input(v||(v=a(["\nflex-grow: 1;\nmargin-top: calc(.375rem - 2px);\npadding: 0;\nbox-sizing: border-box;\nborder: none;\nfont-family: inherit;\nfont-size: inherit;\nbackground-color: inherit;\nline-height: inherit;\ncolor: #495057;\n\n&:focus {\n    outline: 0;\n}\n"]))),U=function(e){var n=e.inputRef,t=e.placeholder,o=e.value,i=e.onSearchChange,l=e.disabled;return r.default.createElement(B,{ref:n,placeholder:t,value:o,onChange:function(e){return i(e.target.value)},disabled:l})},M=o.default.span(h||(h=a(["\npadding-right: 3px;\npadding-left: 3px;\nfont-weight: 700;\nfont-size: 1.25rem;\ncolor: #bdc6d0;\nalign-self: center;\n\n&:hover {\n    color: #343a40;\n}\n"]))),$=function(e){var n=e.onClick;return r.default.createElement(M,{onClick:n,title:"Очистить"},"×")},q=o.default.div(m||(m=a(["\ndisplay: flex;\nflex: 1;\nalign-items: flex-end;\n"]))),_=o.default.span(x||(x=a(["\nflex: 1;\ncolor: #495057;\n"]))),F=function(e){var n=e.value,t=e.renderValueText,o=e.input,i=e.onClear;return r.default.createElement(q,null,n?r.default.createElement(r.default.Fragment,null,r.default.createElement(_,null,t(n)),r.default.createElement($,{onClick:i})):o)},W=o.default(z)(y||(y=a(["\ncursor: default;\n"]))),G=function(){return r.default.createElement(W,null,"Продолжайте ввод, чтобы начался поиск")},J=o.default(z)(w||(w=a(["\ncursor: default;\ntext-align: center;\n"]))),N=o.default.span(O||(O=a(["\n@keyframes spinner-border {\n  to { transform: rotate(360deg); }\n}\ndisplay: inline-block;\nwidth: 1rem;\nheight: 1rem;\nvertical-align: text-bottom;\nborder: .25em solid currentColor;\nborder-right-color: transparent;\nborder-radius: 50%;\nborder-width: .2em;\nanimation: spinner-border .75s linear infinite;\ncolor: #6c757d!important;\n"]))),Q=function(){return r.default.createElement(J,null,r.default.createElement(N,null))},X=["options","value","onChange","onSearchChange","threshold","isLoading","getOptionKey","renderOptionText","renderValueText","dropdownHeight","placeholder","disabled"],Y=o.default.div(E||(E=a(["\ndisplay: flex;\nalign-items: center;\npadding: 0;\npadding-right: .75rem;\nmargin-top: calc(.375rem - 2px);\nmargin-right: .375rem;\ncolor: #495057;\nfont-size: 1rem;\ncursor: pointer;\nborder: 1px solid #bdc6d0;\nborder-radius: .2rem;\n"]))),Z=o.default.span(k||(k=a(["\npadding-right: 3px;\npadding-left: 3px;\nmargin-right: 1px;\nmargin-left: 3px;\nfont-weight: 700;\ncolor: #bdc6d0;\n\n&:hover {\n    color: #343a40;\n}\n"]))),ee=function(e){var n=e.onItemRemove,t=e.children;return r.default.createElement(Y,null,r.default.createElement(Z,{onClick:function(e){e.stopPropagation(),n()}},"×"),t)},ne=o.default.div(C||(C=a(["\ndisplay: flex;\nflex-wrap: wrap;\nflex: 1;\n"]))),te=function(e){var n=e.selected,t=e.getOptionKey,o=e.renderValueText,i=e.onItemRemove,l=e.input;return r.default.createElement(ne,null,n.map((function(e){return r.default.createElement(ee,{key:t(e),onItemRemove:function(){return i(e)}},o(e))})),l)},re=["options","value","onChange","getOptionKey","renderOptionText","renderValueText","dropdownHeight","placeholder","disabled","getSearchValue"];exports.Autocomplete=function(n){var t=n.options,o=void 0===t?[]:t,a=n.value,c=void 0===a?null:a,d=n.onChange,f=void 0===d?function(){}:d,s=n.onSearchChange,p=void 0===s?function(){}:s,g=n.threshold,b=void 0===g?3:g,v=n.isLoading,h=void 0!==v&&v,m=n.getOptionKey,x=void 0===m?function(e){var n;return null!==(n=e.id)&&void 0!==n?n:e}:m,y=n.renderOptionText,w=void 0===y?function(e){return e}:y,O=n.renderValueText,E=void 0===O?function(e){return w(e)}:O,k=n.dropdownHeight,C=void 0===k?300:k,K=n.placeholder,z=void 0===K?"Начните ввод для поиска":K,A=n.disabled,V=void 0!==A&&A,H=l(n,X),D=u(e.useState(""),2),B=D[0],M=D[1],$=T(),q=$.inputRef,_=$.focus,W=$.blur,J=B.length<=b?r.default.createElement(G,null):null,N=h?r.default.createElement(Q,null):null,Y=e.useCallback((function(e){var n=e.length<=b||e.length>b+1&&!h&&0===o.length&&e.startsWith(B);M(e),n||p(e)}),[p,h,o,b,B]),Z=e.useCallback((function(e){f(e),Y("")}),[f,Y]),ee=j({onEscape:function(){W(),Y("")},onOptionSelect:Z,options:o,search:B,value:c}),ne=ee.dropdown,te=ee.pointer,re=ee.handleKeyDown,oe=e.useCallback((function(){ne.escape()}),[ne]),ie=e.useCallback((function(){o.length&&B.length>b&&ne.toggle(),_()}),[_,ne,o,B,b]),le=e.useCallback((function(){Z(null)}),[Z]),ae=P(oe),ue=S(ae),ce=R(ue,C),de=r.default.createElement(U,{inputRef:q,placeholder:c?null:z,value:B,onSearchChange:Y,disabled:V});return r.default.createElement(I,i({ref:ae,dropdownPosition:ce,isDropdownOpen:ne.isOpen,onKeyDown:re,onClick:ie,disabled:V},H),r.default.createElement(F,{value:c,renderValueText:E,input:de,onClear:le}),ne.isOpen&&!V?r.default.createElement(L,{content:J||N||null,options:o,getOptionKey:x,renderOptionText:w,onSelectOption:Z,pointer:te.position,onUpdatePointer:te.setPosition,parentBounds:ue,maxHeight:300,position:ce}):null)},exports.Multiselect=function(n){var t=n.options,o=void 0===t?[]:t,a=n.value,d=void 0===a?[]:a,f=n.onChange,s=void 0===f?function(){}:f,p=n.getOptionKey,g=void 0===p?function(e){var n;return null!==(n=e.id)&&void 0!==n?n:e}:p,b=n.renderOptionText,v=void 0===b?function(e){return e}:b,h=n.renderValueText,m=void 0===h?function(e){return v(e)}:h,x=n.dropdownHeight,y=void 0===x?300:x,w=n.placeholder,O=void 0===w?"Начните ввод для поиска":w,E=n.disabled,k=void 0!==E&&E,C=n.getSearchValue,K=void 0===C?function(e){return v(e)}:C,z=l(n,re),A=u(e.useState(""),2),V=A[0],H=A[1],D=u(e.useState(o),2),B=D[0],M=D[1],$=T(),q=$.inputRef,_=$.focus,F=$.blur,W=e.useCallback((function(e){H(e);var n=""===e?o:function(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(e){return e},r=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),o=new RegExp(r,"i");return e.filter((function(e){return o.test(t(e))}))}(o,e,K);M(n)}),[o,K]),G=e.useCallback((function(e){s(e),W(""),_()}),[_,s,W]),J=e.useCallback((function(e){var n,t=d.findIndex((function(n){return g(n)===g(e)}));n=-1!==t?[].concat(c(d.slice(0,t)),c(d.slice(t+1))):[].concat(c(d),[e]),G(n)}),[d,g,G]),N=e.useCallback((function(e){var n=d.filter((function(n){return g(n)!==g(e)}));G(n)}),[d,g,G]),Q=j({onEscape:function(){F(),W("")},onOptionSelect:J,options:B,search:V,value:d}),X=Q.dropdown,Y=Q.pointer,Z=Q.handleKeyDown,ee=e.useCallback((function(){X.escape()}),[X]),ne=e.useCallback((function(){X.toggle(),_()}),[X,_]),oe=P(ee),ie=S(oe),le=R(ie,y),ae=r.default.createElement(U,{inputRef:q,placeholder:d.length?null:O,value:V,onSearchChange:W,disabled:k});return r.default.createElement(I,i({ref:oe,dropdownPosition:le,isDropdownOpen:X.isOpen,onKeyDown:Z,onClick:ne,disabled:k},z),r.default.createElement(te,{selected:d,getOptionKey:g,renderValueText:m,onItemRemove:N,input:ae}),X.isOpen&&!k?r.default.createElement(L,{options:B,getOptionKey:g,renderOptionText:v,onSelectOption:J,pointer:Y.position,onUpdatePointer:Y.setPosition,selectedItems:d,parentBounds:ie,maxHeight:300,position:le}):null)};
//# sourceMappingURL=index.js.map
